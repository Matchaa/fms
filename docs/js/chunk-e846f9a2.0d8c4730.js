(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e846f9a2"],{"02f4":function(e,t,n){var r=n("4588"),a=n("be13");e.exports=function(e){return function(t,n){var i,o,c=String(a(t)),u=r(n),s=c.length;return u<0||u>=s?e?"":void 0:(i=c.charCodeAt(u),i<55296||i>56319||u+1===s||(o=c.charCodeAt(u+1))<56320||o>57343?e?c.charAt(u):i:e?c.slice(u,u+2):o-56320+(i-55296<<10)+65536)}}},"0390":function(e,t,n){"use strict";var r=n("02f4")(!0);e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},"0a49":function(e,t,n){var r=n("9b43"),a=n("626a"),i=n("4bf8"),o=n("9def"),c=n("cd1c");e.exports=function(e,t){var n=1==e,u=2==e,s=3==e,l=4==e,f=6==e,d=5==e||f,p=t||c;return function(t,c,m){for(var h,b,g=i(t),v=a(g),y=r(c,m,3),w=o(v.length),x=0,S=n?p(t,w):u?p(t,0):void 0;w>x;x++)if((d||x in v)&&(h=v[x],b=y(h,x,g),e))if(n)S[x]=b;else if(b)switch(e){case 3:return!0;case 5:return h;case 6:return x;case 2:S.push(h)}else if(l)return!1;return f?-1:s||l?l:S}}},1169:function(e,t,n){var r=n("2d95");e.exports=Array.isArray||function(e){return"Array"==r(e)}},"1af6":function(e,t,n){var r=n("63b6");r(r.S,"Array",{isArray:n("9003")})},"28a5":function(e,t,n){"use strict";var r=n("aae3"),a=n("cb7c"),i=n("ebd6"),o=n("0390"),c=n("9def"),u=n("5f1b"),s=n("520a"),l=n("79e5"),f=Math.min,d=[].push,p="split",m="length",h="lastIndex",b=4294967295,g=!l((function(){RegExp(b,"y")}));n("214f")("split",2,(function(e,t,n,l){var v;return v="c"=="abbc"[p](/(b)*/)[1]||4!="test"[p](/(?:)/,-1)[m]||2!="ab"[p](/(?:ab)*/)[m]||4!="."[p](/(.?)(.?)/)[m]||"."[p](/()()/)[m]>1||""[p](/.?/)[m]?function(e,t){var a=String(this);if(void 0===e&&0===t)return[];if(!r(e))return n.call(a,e,t);var i,o,c,u=[],l=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),f=0,p=void 0===t?b:t>>>0,g=new RegExp(e.source,l+"g");while(i=s.call(g,a)){if(o=g[h],o>f&&(u.push(a.slice(f,i.index)),i[m]>1&&i.index<a[m]&&d.apply(u,i.slice(1)),c=i[0][m],f=o,u[m]>=p))break;g[h]===i.index&&g[h]++}return f===a[m]?!c&&g.test("")||u.push(""):u.push(a.slice(f)),u[m]>p?u.slice(0,p):u}:"0"[p](void 0,0)[m]?function(e,t){return void 0===e&&0===t?[]:n.call(this,e,t)}:n,[function(n,r){var a=e(this),i=void 0==n?void 0:n[t];return void 0!==i?i.call(n,a,r):v.call(String(a),n,r)},function(e,t){var r=l(v,e,this,t,v!==n);if(r.done)return r.value;var s=a(e),d=String(this),p=i(s,RegExp),m=s.unicode,h=(s.ignoreCase?"i":"")+(s.multiline?"m":"")+(s.unicode?"u":"")+(g?"y":"g"),y=new p(g?s:"^(?:"+s.source+")",h),w=void 0===t?b:t>>>0;if(0===w)return[];if(0===d.length)return null===u(y,d)?[d]:[];var x=0,S=0,_=[];while(S<d.length){y.lastIndex=g?S:0;var k,N=u(y,g?d:d.slice(S));if(null===N||(k=f(c(y.lastIndex+(g?0:S)),d.length))===x)S=o(d,S,m);else{if(_.push(d.slice(x,S)),_.length===w)return _;for(var A=1;A<=N.length-1;A++)if(_.push(N[A]),_.length===w)return _;S=x=k}}return _.push(d.slice(x)),_}]}))},"40c3":function(e,t,n){var r=n("6b4c"),a=n("5168")("toStringTag"),i="Arguments"==r(function(){return arguments}()),o=function(e,t){try{return e[t]}catch(n){}};e.exports=function(e){var t,n,c;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=o(t=Object(e),a))?n:i?r(t):"Object"==(c=r(t))&&"function"==typeof t.callee?"Arguments":c}},"469f":function(e,t,n){n("6c1c"),n("1654"),e.exports=n("7d7b")},4890:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:"新增送货单",visible:e.show,width:"1000px"},on:{"update:visible":function(t){e.show=t},open:e.dialogOpen}},[n("el-form",{ref:"form",staticClass:"form",attrs:{model:e.form,rules:e.rules,inline:!0}},[n("el-form-item",{attrs:{label:"送货单号",prop:"num"}},[n("el-input",{attrs:{disabled:"",placeholder:"系统自动输入送货单号"},model:{value:e.form.num,callback:function(t){e.$set(e.form,"num",t)},expression:"form.num"}})],1),n("el-form-item",{attrs:{label:"状态",prop:"state"}},[n("el-select",{attrs:{placeholder:"请选择状态"},model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}},[n("el-option",{attrs:{label:"未打印",value:"未打印"}}),n("el-option",{attrs:{label:"未发货",value:"未发货"}}),n("el-option",{attrs:{label:"已发货",value:"已发货"}})],1)],1),n("el-form-item",{attrs:{label:"客户名称",prop:"customer"}},[n("el-select",{attrs:{filterable:"",placeholder:"请选择客户"},on:{change:e.customerChange},model:{value:e.form.customer,callback:function(t){e.$set(e.form,"customer",t)},expression:"form.customer"}},e._l(e.customerList,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),n("el-form-item",{attrs:{label:"客户地址",prop:"address"}},[n("el-input",{attrs:{disabled:"",placeholder:"请输入客户地址"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),n("el-form-item",{attrs:{label:"联系电话",prop:"phone"}},[n("el-input",{attrs:{disabled:"",placeholder:"请输入联系电话"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),n("el-form-item",{attrs:{label:"送货时间",prop:"date"}},[n("el-date-picker",{attrs:{type:"date",placeholder:"请选择送货日期"},on:{change:e.dateChange},model:{value:e.form.date,callback:function(t){e.$set(e.form,"date",t)},expression:"form.date"}})],1)],1),n("el-button",{attrs:{type:"primary"},on:{click:e.addRow}},[e._v("添加")]),n("el-table",{staticClass:"table",attrs:{data:e.tableData}},[e._l(e.tableHeader,(function(t,r){return n("el-table-column",{key:r,attrs:{prop:r,label:t.title,width:t.width||150},scopedSlots:e._u([{key:"default",fn:function(a){return["select"===t.type?n("el-select",{attrs:{filterable:"",placeholder:"请选择"+t.title,size:"small"},on:{change:function(n){return e.headerChange(t,a)}},model:{value:a.row[r],callback:function(t){e.$set(a.row,r,t)},expression:"scope.row[key]"}},e._l(t.list,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1):e._e(),"input"===t.type?n("el-input",{attrs:{disabled:e.isHeaderDisabled(t,a)||""===a.row.productType||!1,placeholder:"请输入"+t.title,size:"small"},on:{change:function(n){return e.headerChange(t,a)}},model:{value:a.row[r],callback:function(t){e.$set(a.row,r,t)},expression:"scope.row[key]"}}):"inputNumber"===t.type?n("el-input-number",{attrs:{disabled:e.isHeaderDisabled(t,a)||""===a.row.productType||!1,precision:t.precision||0,step:t.step||1,min:t.min||0,size:"small"},on:{change:function(n){return e.headerChange(t,a)}},model:{value:a.row[r],callback:function(t){e.$set(a.row,r,t)},expression:"scope.row[key]"}}):e._e()]}}],null,!0)})})),n("el-table-column",{attrs:{fixed:"right",label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"small",type:"danger"},nativeOn:{click:function(n){return n.preventDefault(),e.deleteRow(t.$index)}}},[n("i",{staticClass:"el-icon-delete table__delete"})])]}}])})],2),n("div",{staticClass:"meta"},[e._v("备注：净尺寸和毛尺寸规格参考格式：100*100*100(方板长*宽*高)，100*100(圆板直径*长度)。")]),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.onCancel}},[e._v("重 置")]),n("el-button",{attrs:{type:"primary"},on:{click:e.onCertain}},[e._v("确 定")])],1)],1)},a=[],i=(n("7f7f"),n("7514"),n("5d58")),o=n.n(i),c=n("67bb"),u=n.n(c);function s(e){return s="function"===typeof u.a&&"symbol"===typeof o.a?function(e){return typeof e}:function(e){return e&&"function"===typeof u.a&&e.constructor===u.a&&e!==u.a.prototype?"symbol":typeof e},s(e)}function l(e){return l="function"===typeof u.a&&"symbol"===s(o.a)?function(e){return s(e)}:function(e){return e&&"function"===typeof u.a&&e.constructor===u.a&&e!==u.a.prototype?"symbol":s(e)},l(e)}n("ac6a"),n("456d");var f=n("c1df"),d=n.n(f),p=n("768b"),m=(n("c5f6"),n("28a5"),n("c631"));m["a"].getData("PRODUCT_DATA").then((function(e){w.product.list=e.data}));var h=function(e,t,n,r){var a=t.$index,i=t.row;i[n]=r||"",i.size="",e.$set(e.tableData,a,i)},b=function(e,t,n,r){var a=t.$index,i=t.row;i[n]=r,e.$set(e.tableData,a,i)},g=function(e,t){var n=t.row;if(""!==n.size){var r=n.size*n.amount;b(e,t,"weight",r),v(e,t),y(e,t)}},v=function(e,t){var n=t.row,r=n.weight*n.unitPrice;b(e,t,"price",r),y(e,t)},y=function(e,t){var n=t.row,r=n.price+n.material+("rect"===n.productType?n.machining+n.flashSide+n.gasCut:n.saw);b(e,t,"totalPrice",r)},w={product:{title:"产品名称",type:"select",list:[],change:function(e,t){var n=t.$index,r=t.row,a=w.product.list.find((function(e){return e.id===r.product})),i=a.typeId,o=a.name;r.productType!==i&&(r={product:r.product,productName:o,productType:i,generalStandards:"",additionalStandards:"",size:"",amount:1,weight:"",unitPrice:1,price:"",material:0,machining:0,flashSide:0,gasCut:0,saw:0,totalPrice:"",remarks:""}),e.$set(e.tableData,n,r)}},generalStandards:{title:"净尺寸规格",type:"input",change:function(e,t){var n,r=t.row,a=r.generalStandards.split("*"),i=a.every((function(e){return e>=0}));if(!i)return h(e,t,"generalStandards"),void e.$message.warning("净尺寸规格只能为大于等于0的数字！");if("rect"===r.productType){if(3!==a.length)return h(e,t,"generalStandards"),void e.$message.warning("请按照方板参考格式输入净尺寸规格！");if(""===r.additionalStandards)return;var o=r.additionalStandards.split("*");n=a.map((function(e,t){return Number(e)+Number(o[t])})).reduce((function(e,t){return e*t}))}else if("round"===r.productType){if(2!==a.length)return h(e,t,"generalStandards"),void e.$message.warning("请按照圆板参考格式输入净尺寸规格！");var c=Object(p["a"])(a,2),u=c[0],s=c[1];n=Math.pow(u/2,2)*s*3.14}var l=(7.85*n*1e-6).toFixed(2);b(e,t,"size",l),g(e,t)}},additionalStandards:{title:"毛尺寸规格",type:"input",disabled:function(e){var t=e.productType;return"rect"!==t},change:function(e,t){var n=t.row,r=n.generalStandards.split("*"),a=r.every((function(e){return e>=0}));if(!a)return h(e,t,"generalStandards"),void e.$message.warning("毛尺寸规格只能为大于等于0的数字！");if(3!==r.length)return h(e,t,"generalStandards"),void e.$message.warning("请按照方板参考格式输入毛尺寸规格！");if(""!==n.generalStandards){var i=n.generalStandards.split("*"),o=r.map((function(e,t){return Number(e)+Number(i[t])})).reduce((function(e,t){return e*t})),c=(7.85*o*1e-6).toFixed(2);b(e,t,"size",c),g(e,t)}}},amount:{title:"件数",type:"inputNumber",min:1,change:function(e,t){g(e,t)}},weight:{title:"重量",name:"weight",type:"input",disabled:!0,change:function(e,t){v(e,t)}},unitPrice:{title:"单价",name:"unitPrice",precision:2,type:"inputNumber",change:function(e,t){v(e,t)}},price:{title:"金额",name:"price",type:"input",disabled:!0},material:{title:"材料费",name:"material",precision:2,type:"inputNumber",change:function(e,t){y(e,t)}},machining:{title:"精加工",name:"machining",precision:2,type:"inputNumber",disabled:function(e){var t=e.productType;return"rect"!==t},change:function(e,t){y(e,t)}},flashSide:{title:"飞边",name:"flashSide",precision:2,type:"inputNumber",disabled:function(e){var t=e.productType;return"rect"!==t},change:function(e,t){y(e,t)}},gasCut:{title:"气割费",name:"gasCut",precision:2,type:"inputNumber",disabled:function(e){var t=e.productType;return"rect"!==t},change:function(e,t){y(e,t)}},saw:{title:"锯费",name:"saw",precision:2,type:"inputNumber",disabled:function(e){var t=e.productType;return"round"!==t},change:function(e,t){y(e,t)}},totalPrice:{title:"总金额",name:"totalPrice",type:"input",disabled:!0},remarks:{title:"备注",name:"remarks",type:"input",width:200}},x=w,S={data:function(){return{show:!1,detail:{},form:{state:"未打印",num:"",customer:"",address:"",phone:"",date:""},rules:{customer:[{required:!0,message:"请选择客户",trigger:"blur"}],date:[{required:!0,message:"请选择日期",trigger:"blur"}]},customerList:[],tableData:[]}},computed:{tableHeader:function(){return x}},mounted:function(){},methods:{dialogOpen:function(){var e=this;this.reFindCustomerList().then((function(){if(Object.keys(e.detail).length){for(var t in e.form)e.form[t]=e.detail[t]||"";e.tableData=e.detail.productData}else e.onCancel()}))},isHeaderDisabled:function(e,t){var n=e.disabled;switch(l(n)){case"boolean":return e.disabled;case"function":return e.disabled(t.row)}},headerChange:function(e,t){e.change&&e.change(this,t)},reFindCustomerList:function(){var e=this;return this.$db.getData("CUSTOMER_DATA").then((function(t){e.customerList=t.data}))},customerChange:function(e){var t=this.customerList.find((function(t){return t.id===e}));this.form.address=t.address,this.form.phone=t.phone},dateChange:function(e){this.form.date=d()(e).format("YYYY-MM-DD")},addRow:function(){this.tableData.unshift({product:"",productName:"",productType:"",generalStandards:"",additionalStandards:"",size:"",amount:1,weight:"",unitPrice:1,price:"",material:0,machining:0,flashSide:0,gasCut:0,saw:0,totalPrice:"",remarks:""})},deleteRow:function(e){this.tableData.splice(e,1)},onCertain:function(){var e=this;this.$refs.form.validate((function(t){if(t){var n=e.tableData.filter((function(e){return""!==e.product||""!==e.size}));if(n.length){var r={id:e.detail.id||(new Date).getTime(),customerName:e.customerList.find((function(t){return t.id===e.form.customer})).name};for(var a in e.form)r[a]=e.form[a];r.num=e.detail.num||d()(new Date).format("YYYYMMDDHHmmss"),r.productData=e.tableData,e.$db.putData("DELIVERYNOTE_DATA",r).then((function(){e.$emit("success"),e.detail.id?e.$message.success("修改送货单成功！"):e.$message.success("新增送货单成功！"),e.show=!1}))}else e.$message.warning("规格完整的产品数量不足一条！")}}))},onCancel:function(){this.$refs.form.resetFields(),this.tableData=[],this.addRow()}},components:{}},_=S,k=(n("4aaa"),n("2877")),N=Object(k["a"])(_,r,a,!1,null,"b5b8e860",null);t["default"]=N.exports},"4aaa":function(e,t,n){"use strict";var r=n("9de2"),a=n.n(r);a.a},"54a1":function(e,t,n){n("6c1c"),n("1654"),e.exports=n("95d5")},"5d58":function(e,t,n){e.exports=n("d8d6")},"5d73":function(e,t,n){e.exports=n("469f")},"5dbc":function(e,t,n){var r=n("d3f4"),a=n("8b97").set;e.exports=function(e,t,n){var i,o=t.constructor;return o!==n&&"function"==typeof o&&(i=o.prototype)!==n.prototype&&r(i)&&a&&a(e,i),e}},"67bb":function(e,t,n){e.exports=n("f921")},7514:function(e,t,n){"use strict";var r=n("5ca1"),a=n("0a49")(5),i="find",o=!0;i in[]&&Array(1)[i]((function(){o=!1})),r(r.P+r.F*o,"Array",{find:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")(i)},"768b":function(e,t,n){"use strict";var r=n("a745"),a=n.n(r);function i(e){if(a()(e))return e}var o=n("5d73"),c=n.n(o),u=n("c8bb"),s=n.n(u);function l(e,t){if(s()(Object(e))||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,a=!1,i=void 0;try{for(var o,u=c()(e);!(r=(o=u.next()).done);r=!0)if(n.push(o.value),t&&n.length===t)break}catch(l){a=!0,i=l}finally{try{r||null==u["return"]||u["return"]()}finally{if(a)throw i}}return n}}function f(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function d(e,t){return i(e)||l(e,t)||f()}n.d(t,"a",(function(){return d}))},"7cd6":function(e,t,n){var r=n("40c3"),a=n("5168")("iterator"),i=n("481b");e.exports=n("584a").getIteratorMethod=function(e){if(void 0!=e)return e[a]||e["@@iterator"]||i[r(e)]}},"7d7b":function(e,t,n){var r=n("e4ae"),a=n("7cd6");e.exports=n("584a").getIterator=function(e){var t=a(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return r(t.call(e))}},"8b97":function(e,t,n){var r=n("d3f4"),a=n("cb7c"),i=function(e,t){if(a(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{r=n("9b43")(Function.call,n("11e9").f(Object.prototype,"__proto__").set,2),r(e,[]),t=!(e instanceof Array)}catch(a){t=!0}return function(e,n){return i(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:i}},"95d5":function(e,t,n){var r=n("40c3"),a=n("5168")("iterator"),i=n("481b");e.exports=n("584a").isIterable=function(e){var t=Object(e);return void 0!==t[a]||"@@iterator"in t||i.hasOwnProperty(r(t))}},"9de2":function(e,t,n){},a745:function(e,t,n){e.exports=n("f410")},aa77:function(e,t,n){var r=n("5ca1"),a=n("be13"),i=n("79e5"),o=n("fdef"),c="["+o+"]",u="​",s=RegExp("^"+c+c+"*"),l=RegExp(c+c+"*$"),f=function(e,t,n){var a={},c=i((function(){return!!o[e]()||u[e]()!=u})),s=a[e]=c?t(d):o[e];n&&(a[n]=s),r(r.P+r.F*c,"String",a)},d=f.trim=function(e,t){return e=String(a(e)),1&t&&(e=e.replace(s,"")),2&t&&(e=e.replace(l,"")),e};e.exports=f},aae3:function(e,t,n){var r=n("d3f4"),a=n("2d95"),i=n("2b4c")("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[i])?!!t:"RegExp"==a(e))}},c5f6:function(e,t,n){"use strict";var r=n("7726"),a=n("69a8"),i=n("2d95"),o=n("5dbc"),c=n("6a99"),u=n("79e5"),s=n("9093").f,l=n("11e9").f,f=n("86cc").f,d=n("aa77").trim,p="Number",m=r[p],h=m,b=m.prototype,g=i(n("2aeb")(b))==p,v="trim"in String.prototype,y=function(e){var t=c(e,!1);if("string"==typeof t&&t.length>2){t=v?t.trim():d(t,3);var n,r,a,i=t.charCodeAt(0);if(43===i||45===i){if(n=t.charCodeAt(2),88===n||120===n)return NaN}else if(48===i){switch(t.charCodeAt(1)){case 66:case 98:r=2,a=49;break;case 79:case 111:r=8,a=55;break;default:return+t}for(var o,u=t.slice(2),s=0,l=u.length;s<l;s++)if(o=u.charCodeAt(s),o<48||o>a)return NaN;return parseInt(u,r)}}return+t};if(!m(" 0o1")||!m("0b1")||m("+0x1")){m=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof m&&(g?u((function(){b.valueOf.call(n)})):i(n)!=p)?o(new h(y(t)),n,m):y(t)};for(var w,x=n("9e1e")?s(h):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;x.length>S;S++)a(h,w=x[S])&&!a(m,w)&&f(m,w,l(h,w));m.prototype=b,b.constructor=m,n("2aba")(r,p,m)}},c8bb:function(e,t,n){e.exports=n("54a1")},cd1c:function(e,t,n){var r=n("e853");e.exports=function(e,t){return new(r(e))(t)}},e853:function(e,t,n){var r=n("d3f4"),a=n("1169"),i=n("2b4c")("species");e.exports=function(e){var t;return a(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!a(t.prototype)||(t=void 0),r(t)&&(t=t[i],null===t&&(t=void 0))),void 0===t?Array:t}},f410:function(e,t,n){n("1af6"),e.exports=n("584a").Array.isArray},fdef:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);
//# sourceMappingURL=chunk-e846f9a2.0d8c4730.js.map